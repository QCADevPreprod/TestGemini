// {fact rule=file_injection_js_rule@v1.0 defects=1}

const libxmljs = require("libxmljs");
var fs = require('fs');

function non_conformant(){

var xml = fs.readFileSync('xxe.xml', 'utf8');

var xmlDoc = libxmljs.parseXmlString(xml, { noblanks: true, noent: true, nocdata: true }); // Nonconformant: noent set to true

}

// {/fact}

// {fact rule=file_injection_js_rule@v1.0 defects=0}

function conformant(){

    var xml = fs.readFileSync('xxe.xml', 'utf8');
    
    var xmlDoc = libxmljs.parseXmlString(xml, { noblanks: true, noent: false, nocdata: true }); // Conformant
    
}